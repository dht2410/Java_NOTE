## 表

### 索引组织表

在InnoDB中，表都是按主键顺序存放的。

### InnoDB存储逻辑结构

所有数据都被逻辑地址存放在一个空间中，称为表空间。表空间由段（segment）、区（extend）、页（page）组成。

###### （1）表空间

默认情况所有数据共享一个表空间ibdatal。包含回滚信息、插入缓冲索引页、系统事务信息、二次写缓冲等。

###### （2）段

数据段、索引段、回滚段

数据段即为B+树的叶子节点，索引段即为非索引节点。

###### （3）区

由连续的页组成。每个区为1MB。一个区64个连续的页。

###### （4）页

磁盘管理的最小单位。16Kb。

每页至少存储两个记录，因为B+树的性质。如果行太大，则会存储前缀数据，剩下的放在行溢出页（BL0B）



### 数据页结构

![image-20200606205009842](C:\Users\dht24\AppData\Roaming\Typora\typora-user-images\image-20200606205009842.png)

File Header 字段用于记录 Page 的头信息，其中比较重要的是 FIL_PAGE_PREV 和 FIL_PAGE_NEXT 字段，通过这两个字段，我们可以找到该页的上一页和下一页，实际上所有页通过两个字段可以形成一条双向链表。

Page Header 字段用于记录 Page 的状态信息。

Infimun记录是比该页任何主键都小的值，Supremun是最大的

一条记录被删除后，就会加入Free Space

B+树索引本身并不能找到具体的一条记录，能找到只是改记录所在的页。数据库把页载到内存，然后通过Page Directory进行二分查找。

File Trailer检测完整性

### 分区表

逻辑上只有一个表，但物理上可由很多物理分区组成，变成很多个文件。

MySQL的分区是一个分区既存放了数据又存放了索引。

分区依据有通过RANGE和HASH