因特网网络层三个组件：
	1.IP协议
	2.选路组件，确定路由器中的转发表
	3.报告数据差错和对某些网络层信息进行响应的协议，即互联网控制报文协议（ICMP）
	
数据报格式：
首部：
	版本号  4比特
	首部长度  4比特  因为某些首部有选项部分，所以需要首部长度确定数据从哪里开始
	服务类型  8比特  将不同类型的数据报分开，例如将实时数据报和非实时流量区分开
	数据报长度  16比特  数据加首部总长度
	
	16比特标识、3比特标志、13比特片偏移   与IP分片有关
	
	寿命（TTL）  确保该数据报不会永远在网络中循环，每经过一台路由器，TTL--
	上层协议号   在端系统中，确定是TCP还是UDP，是网络层与运输层的粘合剂
	首部检验和   帮助路由器检测收到的数据报中的比特错误
	
	32比特源IP地址
	
	32比特目的IP地址
	
	以上5块为所有首部必有的，共20字节
	
	选项（如果有的话），在IPv6中已停用
	
数据：
	若为TCP，则该分组首部包括20字节IP首部、20字节TCP首部和应用层报文


IP数据报分片
	一个链路层能承受的最大数据量叫最大传输单元（MTU），但各个链路的MTU不同，因此一个IP数据报经过时，可能盛不下，
	需要分片
	为了使网络还是很简单，把重装分片的工作放在端系统中，而不是路由器
	当一个路由器将同一个数据报分片，则对于每一片，
	其标识置为相同的（用于区分同一片），偏移offset表示插入的数据开始于哪个字节，用于重装
	标志flag用于确定最后一片到达（最后一片flag置0，其他置1）
	在端系统，只有重装完成，有效数据才会交付给上层
	
	可能会受到Dos攻击，攻击者发送小片的流，这些流的偏移量都不为0，当端系统试图组装时，会发生崩溃；因此IPv6废除切片

IPv4编址
	一台主机只有一台网络链路连接到网络，主机与物理链路之间的边界叫做接口
	路由器有多个链路和它相连，因此有多个接口
	每台主机和路由器都需要有自己的IP地址，但一个IP地址是与接口相关联的，而不是和包含该接口的主机或路由器相关联
	互联主机接口和路由器一个接口的网络称为子网，路由器的接口和接口之间也叫子网
	
	最左侧24位相同表示一个子网，123.1.1.0/24，表示子网掩码，子网内部IP为123.1.1.xxx
	无类别域间选路（CIDR）：将子网寻址概念一般化，对于子网寻址，32位比特的IP地址被划分为两部分，并且也具有点分十进制形式
					a.b.c.d/x，x表示地址第一部分的比特数，前x位称为网络部分
	一个组织中的IP一般被分配同样的前x个比特，这样在组织外部的路由器转发一个数据报，便只需要考虑该地址前面的x比特
	IP广播地址：255.255.255.255，当一台主机向该地址发送数据时，同一子网的所有设备都可收到
	
	1.主机或子网获取一块地址
	为了获取子网地址块，网络管理员首先与其ISP(Internet Service Provider)联系，ISP从分给他的地址块中划分出一块儿
	2.获取主机地址：动态主机配置协议（DHCP）
	利用DHCP，主机可以自动获取IP地址，主机被分配到一个临时的IP地址，IP每次与该网络连接时可能都是不同的
	每当主机加入或离开时，DHCP便更新其IP地址表，新主机接入，从池子里拿一个地址给它；离开，回收进池子
	一般每个子网拥有一台DHCP服务器，或者一台中继代理服务的路由器
	DHCP协议的4个步骤：
		①DHCP服务器发现。客户机生成一个包含IP发现报文的IP数据报，传递给链路层，链路层广播，广播目的地址为255.255.255.255
		②DHCP服务器提供。DHCP服务器收到报文时，用一个DHCP提供报文响应，也用255.255.255.255广播
		③DHCP请求。客户机从提供服务的DHCP中选择一个，并用一个DHCP请求报文对选中的服务器响应，回显配置参数
		④DHCP ACK。对DHCP请求报文进行响应，证实所要求的参数。
	3.网络地址转换（NAT）
		WAN:广域网   LAN:局域网
		解决网络设备变多，地址不够用的问题
		在本局域网内，使用一个IP地址，但转发到局域网外时，需要另外的IP
		需要NAT使能路由器，当该局域网转发到局域网外时，统一用该路由器的IP地址，接收外界时，也用这个IP。
		该路由器对外界隐藏了局域网的细节
		对外界发过来的数据，怎样确定应该给局域网中的谁，这需要NAT使能路由器的NAT转换表，表项中包含端口号和IP地址
		NAT使能路由器做的就是把局域网内设备的IP和端口号与它自身发出去的端口号对应起来，当收到目的端口号时，进行匹配对应
	4.UPnP
		提供NAT穿越

ICMP：互联网控制报文协议
	用于主机和路由器交互网络层信息，典型应用上差错报告
	其实时位于IP之上的，作为IP的有效载荷，类似于TCP和UDP
	报文有一个类型字段和编码字段并且包含引起该报文生成的IP数据报首部和前8字节内容

防火墙：检查数据报，一般由接入路由器承担

IPv6：
	相比IPv4的变化：
	1.扩大地址容量。将32位IP地址扩展为128位。
	2.40字节首部。除了两个各占16字节的源地址和目的地址，只有8字节的其他首部
	3.流标签与优先级。与IPv4中服务类型字段类似
	
	比IPv4少的字段：
	1.分片/重新组装。不允许在路由器上分片和重新组装。如果路由器收到的数据报太大，则生成一个ICMP报文，通知发送方分组太大
	2.首部检验和。在运输层和数据链路层已经执行过，所以认为实属多余。
	3.选项。
	
	从IPv4到IPv6迁移：
	1.双栈。既能使用6也能4，当有一个端是4时，就得使用4.
	2.隧道。